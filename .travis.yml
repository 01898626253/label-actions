jobs:
  fast_finish: true
  include:
    - stage: build
      install: docker build --tag ci .ci
      script: docker run --init --rm --mount type=bind,source="${PWD}",target=/app ci
      os: linux
      dist: xenial
      language: generic
      services:
        - docker

deploy:
  - provider: npm
    email: $NPM_EMAIL
    api_key:
      secure: "BVEm8aSAjeys0vgUztEbIcJSnab7BssI6HQVNHeuhj4St7FWecPayZiMCWc8CzgmK/ws+CcNdHhLVAb9s5XJnguKddLG8MnLegd/F7Fe5pgJkgXMhS0mBbTGOD0QcfVS/CiJbrmFnGnBRMc2vM15sNkx3C9ekUnU8nGsZZF5yuwi+UR/B7AakN/Tv2N4eEAcWId3J4N3ez3N70umJwsV7WB2RvrOOs/5y7H4miZzKUC7llr45qFtDJNopcZbrEZ3noV8g0Vcwh5z+ykQMAl6kVpZxByT1fL8IPGW+7sIEX8oR8FKDUJvJ7aGrUwlqicmFjERcNzpT8RHKaaAZT8wlnOT75bhy7Onbpyn/RQgB0UI6GAjd+LHbK4dqbw3T6sG4BakT4cO2qr/kAJm6/mclMYGD02PZkV7i+WpGjghzOtYZmOeeD3i7XKlAtc0NKu9S7K8p5reDyLXVXVV76NPE8R38i7J2NUCancysdWZZ6+jPvM20aZ9CnqjQstZxetFKtoWcem4d0dEJF/pElMKka3ucLjrg9rVwk4i5Rou7LlaIjSCLPsThTtAYuQwffu4vOWMbxeQ/do+HoalRaeyjTMyJm+hyOZ30pf0CmPOU6iAghxuo9BfSXkL954l6NhOomTMNZlnqwthCrhohfzQTQ63udxexfQyOhUYwdH1z1o="
    skip_cleanup: true
    on:
      tags: true
